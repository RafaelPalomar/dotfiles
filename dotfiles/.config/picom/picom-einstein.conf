########################################
# Backend & VSync
########################################
backend = "xrender";
vsync = true;                 # Prevents tearing with compositor

use-damage = true;

# Try to auto-detect refresh; 0 = auto
#refresh-rate = 0;

# Avoid legacy/deprecated toggles that cause stutter (e.g. xrender-sync-fence)
# Avoid unredirect to keep things tear-free & consistent
unredir-if-possible = false;

########################################
# General
########################################
detect-transient = true;
detect-client-leader = true;
detect-rounded-corners = true;

# Latency: shorter fade/transition
fade = true;
fade-delta = 8;               # ms per frame
fade-in-step = 0.035;
fade-out-step = 0.035;

# Speed up focus switching
focus-exclude = [
  "name *= 'rofi'",
  "class_g = 'slop'",         # Screenshots
];

########################################
# Shadows
########################################
shadow = true;
shadow-radius = 12;
shadow-offset-x = -12;
shadow-offset-y = -12;
shadow-opacity = 0.45;

# Donâ€™t shadow certain windows (adjust to taste)
shadow-exclude = [
  "name *= 'Notification'",
  "class_g = 'Rofi'",
  "class_g = 'Dmenu'",
  "class_g = 'Polybar'",
  "class_g = 'i3-frame'",
  "class_g = 'Conky'",
  "class_g = 'slop'",
  "window_type = 'dock'",
  "window_type = 'desktop'"
];

########################################
# Opacity
########################################
inactive-opacity = 1.0;       # Keep text crisp on laptops
active-opacity = 1.0;
frame-opacity = 1.0;
opacity-rule = [
  # Example rules (uncomment to use):
  # "90:class_g = 'kitty' && focused",
  "95:class_g = 'Alacritty' && focused",
  "90:class_g = 'Alacritty' && !focused",
  # "90:class_g = 'URxvt' && focused",
  # "95:class_g = 'Code' && focused",
];

########################################
# Blur (disabled in vanilla-safe profile)
########################################
# Most upstream builds support 'dual_kawase' blur but may vary by distro.
# To stay universally compatible, keep blur off here:
blur-method = "none";

########################################
# Corner Rounding (on supported builds; safe to keep 0)
########################################
corner-radius = 0;

########################################
# XSync / GL Tweaks
########################################
glx-no-stencil = true;
glx-no-rebind-pixmap = true;
# Some laptops benefit from this off; try toggling if you see flicker:
# xrender-sync-fence = true;

########################################
# Window Types
########################################
wintypes:
{
  tooltip = { fade = true; shadow = true; opacity = 0.95; focus = true; full-shadow = false; };
  dock    = { shadow = false; };
  dnd     = { shadow = false; };
  menu    = { shadow = true; };
  popup_menu = { shadow = true; };
  dropdown_menu = { shadow = true; };
};
